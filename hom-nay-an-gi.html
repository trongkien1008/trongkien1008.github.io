<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hôm Nay Ăn Gì?</title>
    
    <style>
        /* --- Cài đặt chung --- */
        :root {
            --primary-color: #fa8231; /* Cam */
            --secondary-color: #6c757d;
            --background-color: #f0f2f5;
            --section-bg-color: #ffffff;
            --text-color: #333;
            --border-color: #ddd;
            --success-color: #20bf6b; /* Xanh lá */
            --danger-color: #fc5c65; /* Đỏ */
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }

        /* --- Bố cục 16:9 --- */
        .aspect-ratio-box {
            width: 100%;
            max-width: 1280px;
            aspect-ratio: 16 / 9;
            background: var(--section-bg-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
        }

        /* --- Container chính --- */
        .main-container {
            width: 100%;
            height: 100%;
            display: flex;
            transition: all 0.3s ease;
        }

        /* --- Các khu vực chính --- */
        .section {
            padding: 1.5rem;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        #input-section {
            flex-basis: 40%;
            border-right: 1px solid var(--border-color);
        }

        #display-section {
            flex-basis: 60%;
            justify-content: center; /* Căn giữa nội dung */
        }
        
        /* --- Thành phần trong form --- */
        textarea {
            flex-grow: 1;
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            resize: none;
            box-sizing: border-box;
            margin-bottom: 1rem;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        button {
            flex-grow: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }

        button:active {
            transform: scale(0.98);
        }

        #clear-btn { background-color: var(--danger-color); color: white; }
        #clear-btn:hover { background-color: #eb3b46; }

        #run-btn { background-color: var(--success-color); color: white; font-weight: bold; }
        #run-btn:hover { background-color: #1aa85c; }
        #run-btn:disabled { background-color: #aaa; cursor: not-allowed; }
        
        #fullscreen-btn { background-color: var(--primary-color); color: white; }
        #fullscreen-btn:hover { background-color: #e66a1a; }

        /* --- Phần quay số --- */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 1rem;
        }
        
        #duration-input {
            width: 60px;
            padding: 5px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        #random-name-display {
            width: 100%;
            min-height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary-color);
            background-color: var(--background-color);
            border-radius: 10px;
            margin: 1rem 0;
            text-align: center;
            padding: 1rem;
            box-sizing: border-box;
            overflow: hidden;
        }

        .fullscreen-instructions {
            display: none; /* Ẩn mặc định */
        }

        /* --- Chế độ Toàn màn hình --- */
        body.fullscreen-mode { padding: 0; }
        body.fullscreen-mode .aspect-ratio-box {
            max-width: none; width: 100vw; height: 100vh; border-radius: 0;
        }

        body.fullscreen-mode #input-section,
        body.fullscreen-mode #display-section .controls,
        body.fullscreen-mode .main-controls { /* Ẩn các nút điều khiển */
            display: none;
        }

        body.fullscreen-mode #display-section {
            flex-basis: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
        }

        body.fullscreen-mode #random-name-display {
            flex: none; /* Bỏ flex-grow */
            width: 90%;
            height: 80%;
            font-size: 8vw; /* Kích thước chữ lớn, linh hoạt */
        }

        body.fullscreen-mode .fullscreen-instructions {
            display: block; /* Hiện hướng dẫn */
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #aaa;
            font-size: 0.9rem;
            background-color: rgba(0, 0, 0, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
        }

        /* --- Tương thích với điện thoại (Responsive) --- */
        @media (max-width: 768px) {
            body { padding: 0; align-items: flex-start; }
            .aspect-ratio-box {
                aspect-ratio: unset; width: 100%; height: auto; min-height: 100vh;
                border-radius: 0; box-shadow: none;
            }
            .main-container { flex-direction: column; }
            #input-section {
                flex-basis: 45vh; border-right: none;
                border-bottom: 2px solid var(--border-color);
            }
            #display-section { flex-basis: auto; flex-grow: 1; }
            #random-name-display { font-size: 2rem; min-height: 150px; }
        }
    </style>
</head>
<body>
    <div class="aspect-ratio-box">
        <div class="main-container">
            <div class="section" id="input-section">
                <textarea id="name-list-input" placeholder="Phở bò&#10;Bún chả&#10;Cơm tấm&#10;... (mỗi món một dòng)"></textarea>
                <div class="button-group">
                    <button id="clear-btn">Xoá trắng</button>
                </div>
            </div>

            <div class="section" id="display-section">
                <div class="controls">
                    <label for="duration-input">Thời gian quay (giây):</label>
                    <input type="number" id="duration-input" value="3" min="1">
                </div>
                
                <div id="random-name-display">?</div>

                <div class="button-group main-controls">
                    <button id="run-btn">TÌM MÓN NGAY!</button>
                    <button id="fullscreen-btn">Toàn màn hình</button>
                </div>

                <div class="fullscreen-instructions">Nhấn [R] để quay, [ESC] để thoát</div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Lấy các phần tử từ HTML
            const nameListInput = document.getElementById('name-list-input');
            const clearBtn = document.getElementById('clear-btn');
            const runBtn = document.getElementById('run-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const durationInput = document.getElementById('duration-input');
            const randomNameDisplay = document.getElementById('random-name-display');

            // Biến lưu trữ trạng thái
            let randomInterval = null;

            // Danh sách món ăn mẫu
            const foodList = [
                'Phở bò', 'Bún chả', 'Bún Đậu Mắm Tôm', 'Bánh mì', 'Bún bò Huế',
                'Hủ tiếu 2 Tô', 'Mì Quảng Nam', 'Mỳ Quảng Nha Trang', 'Bánh xèo', 'Gỏi cuốn',
                'Nem nướng', 'Bún đậu mắm tôm', 'Cơm gà','Nhịn đói',
                'Bánh canh', 'Lẩu Thái', 'Lẩu bò', 'Bún Mắm Nêm', 'Bún Mắm Miền Tây',
                'Bò Né', 'Sushi - Cơm Cuộn',
            ];
            
            // Tự động nạp danh sách món ăn khi tải trang
            nameListInput.value = foodList.join('\n');

            // --- CÁC HÀM XỬ LÝ SỰ KIỆN ---

            clearBtn.addEventListener('click', () => nameListInput.value = '');

            runBtn.addEventListener('click', startRandomization);

            fullscreenBtn.addEventListener('click', toggleFullscreen);

            // --- PHÍM TẮT ---
            document.addEventListener('keydown', (event) => {
                if (document.body.classList.contains('fullscreen-mode')) {
                    if (event.key.toLowerCase() === 'r' && !runBtn.disabled) {
                        runBtn.click();
                    }
                    if (event.key === 'Escape') {
                        toggleFullscreen();
                    }
                }
            });

            // --- CÁC HÀM LOGIC ---

            function toggleFullscreen() {
                document.body.classList.toggle('fullscreen-mode');
                fullscreenBtn.textContent = document.body.classList.contains('fullscreen-mode') 
                    ? 'Thoát Toàn màn hình' 
                    : 'Toàn màn hình';
            }

            function startRandomization() {
                const currentList = nameListInput.value.split('\n').map(name => name.trim()).filter(name => name !== '');
                if (currentList.length === 0) {
                    alert('Vui lòng nhập danh sách món ăn!');
                    return;
                }

                runBtn.disabled = true;
                const duration = parseInt(durationInput.value, 10) * 1000;

                randomInterval = setInterval(() => {
                    const randomIndex = Math.floor(Math.random() * currentList.length);
                    randomNameDisplay.textContent = currentList[randomIndex];
                }, 100);

                setTimeout(() => {
                    clearInterval(randomInterval);
                    pickWinner(currentList);
                }, duration);
            }

            function pickWinner(currentList) {
                const winnerIndex = Math.floor(Math.random() * currentList.length);
                const winner = currentList[winnerIndex];

                randomNameDisplay.textContent = winner;
                runBtn.disabled = false;

                if (typeof confetti === 'function') {
                    // Hiệu ứng pháo hoa vui nhộn
                    const end = Date.now() + (2 * 1000);
                    const colors = ['#ffbe76', '#ff7979', '#badc58', '#f0932b', '#eb4d4b', '#6ab04c'];

                    (function frame() {
                        confetti({
                            particleCount: 2,
                            angle: 60,
                            spread: 55,
                            origin: { x: 0 },
                            colors: colors
                        });
                        confetti({
                            particleCount: 2,
                            angle: 120,
                            spread: 55,
                            origin: { x: 1 },
                            colors: colors
                        });

                        if (Date.now() < end) {
                            requestAnimationFrame(frame);
                        }
                    }());
                }
            }
        });
    </script>
</body>

</html>
